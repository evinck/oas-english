# Augmented analysis using Machine Learning

## Introduction

One of the most sophisticated features that Oracle Analytics offers is the ability to leverage advanced analytics and machine learning at the click of a button, directly from your self-service projects and datasets. . Machine learning features include a set of predefined algorithms that can be used to extract insights from your data sets, such as sentiment analysis, time series analysis, prediction results, and score scores. trust.

Advanced analytics features like forecasting, trending, and clustering can be applied to visualization in your canvas with just one click. Additionally, users can call custom machine learning scripts using the script evaluation feature from your self-service projects or by adding custom scripts as part of your data flow during preparation Datas..

## Use Machine Learning to accelerate analysis

In this chapter, we will import a dataset containing multiple employee records with various attributes that record employee experience, performance, and incentives. The data is historical and includes an element that identifies whether the employee has left the organization.

- Note the attrition column, a binary indicator.
- Each employee record contains a "yes" or "no" answer.

Once you import your data into Oracle Analytics, you begin by profiling the data and reviewing semantic recommendations to repair and enrich your data for further analysis. Next, you'll take advantage of an enhanced analysis capability called explain. Explain is used to generate insights through a combination of natural language processing, descriptive statistics, and predictive modeling techniques to better understand our data and gain deeper insights before our analysis.

1. select Create..Workbook.

    !["oaslandingpage"](518a3accf5c1505328cc14a1b15f7809.png)

2. select Create Dataset.

    !["createdataset"](59275ff9fecb8433670dec5e3a66c044.png)

3. Select the file *“AttritionTrainingV3.xlsx”*

    !["draganddropattritiontrainingv3xlsxfiletoaddthedataset"](4f8503453e24db49da9d9ad24878b931.png)

    Click Ok to add the file to the dataset.

    ![](864464fe6fd02fd2eac8a7696d56fd36.png)

    Once done, save the file and name it “AttritionTrainingV3”.

4. Now locate the ID column and click on the hamburger icon at the top of the column. Let's hide this column since the ID column has no bearing on whether an employee stays or leaves our organization.  
    **Note**: This same procedure can be applied to any column that you believe does not impact attrition.

    !["hidetheidcolumn"](dc0787c7511056b0d945b6d6a39617c3.png)

    Similarly, find the Age column and using the properties panel in the lower left corner, change "Treat As" to Attribute and "Data Type" to Text. This is because an employee's age can actually impact attrition, so assessing each distinct age of an employee could be deterministic.

    !["changecolumntoanattributeandit'sdatatypetotext"](660a6187ad4cc4ed201e1d3066b24b37.png)

    Oracle Analytics displays a set of useful column transformations called "Recommendations" when it detects patterns in your data. These recommendations are displayed in a pane on the right. Find the SSN column and select the “Obfuscate Digits of SSN” recommendation to hide this sensitive information from prying eyes. Save the changes we made to the Attrition dataset.

    !["findthessncolumntoviewoasrecommendationthenchooseobfuscatedigitsofssnoption"](1cd209a6bd626da0076898b7297544d6.png)

    **Note**: These helpful recommendations represent a key differentiator for Oracle and are designed to improve end-user productivity while helping customers get more value from their data.

5. Now let's create a workbook using the dataset we just improved by clicking on the "Create Workbook" button at the top right.

    !["clickcreateworkbook"](471498d89a75bf7f11c5ea1d909c00b0.png)

    A new workbook will be opened and the focus should be set to "Visualize" by default. If not, just choose "Visualize" at the top of the page

    !["choosevisualize"](953fb551ca11b3395ca61e7e86dfdd89.png)

    In the "Data Elements" panel on the left side, find the Attrition attribute, then right-click it and select "Explain Attrition".

    !["explainattritionafterrightclickingonthatattribute"](0e67700d0c3897e23eca82eb09b2525f.png)

6. This operation generates an explanation window that provides information about attrition. This information is divided into 4 categories. The first category identifies the basic facts about our attrition attribute. In this case, it performs automatic aggregations on separate lines.

    !["piechartshowingcountofemployeeswholeavethecompany"](caa41e1c0718f1efb9126cb63d438eac.png)

    Since attrition is a binary “yes/no” variable, it presents a pie chart showing the distribution of employees who left or did not leave the company. Scroll down to see more charts generated by Explain. You can select any interesting information you want to share or analyze in more detail by clicking the check mark in the upper right corner of each chart.

    Navigate to the second tab, which identifies key factors related to the attrition attribute. Oracle Analytics leverages machine learning to identify variables with the most deterministic relationship to attrition factors. Bar charts provide a distribution of attrition for each key factor.

    !["keydriversofattrition"](b003646473816c32c7cdb07b1278ea84.png)

    **Note:** Disregard screen order and location for graphics delivered via "Explain".

    Explain also generates segment insights, identifying similarities or grouping profile scenarios where attrition is more or less likely to be a yes or no.

    !["segmentsdrivingattrition"](384046981c83177e1673d333bb2b3aa7.png)

    You can use the drop-down menu to move between groups of segments to identify the confidence level of the scenario.

    The fourth category of information illustrates attrition anomalies or perhaps unexpected items. The fault indicator indicates the combinisons of each distinct attrition value against all columns in the dataset, allowing outliers to be highlighted.

    !["unexpected anomaliesofattrition"](ee41f7b8afd1b99373d34835cb5de3e7.png)

    It visualizes the actual value and the expected value, highlighting places where the actual value and the expected value do not match.

    Select the following charts from the tabs displayed by Explain:

    - Attrition pie chart from the Basic facts about Attrition panel
    - JobRole & Overtime from the Key Drivers of Attrition panel
    - JobRole from the Anomalies of Attrition panel

        **Note:** You may need to click Refresh Display at the bottom of the Attrition Anomalies panel to see all generated graphs.

Now click “Add Selected” at the top right to add these visualizations to your workbook. The result should be a canvas named Explain Attrition containing the visualizations you selected that you can explore further or share.

!["canvasofitemsselected"](cc015128e7cc900c5f743066a1c898bb.png)

7. We can run the “explain” function on other attributes or metrics in our dataset. When you run "explain" on a data item, a new canvas is added to the workbook. Try explaining the "EducationField" attribute and select a few visualizations to create a new canvas.

    !["explaineducationfield"](529818d554614cd1b7e99635ab8fe847.png)

    Select the following charts based on your EducationField results:

    - EducationField pie chart from the Basic Facts about EducationField panel
    - Department and JobRole from the Key Drivers of EducationField panel
    - Overtime anomalies chart from the Anomalies of EducationField panel

**Note**: You may need to click Refresh Display at the bottom of the EducationField Anomalies panel to see all generated graphs.

Click "Add Selected" and a new canvas for EducationField will be added to the workbook, helping us improve our understanding of attrition.

Before moving on to the next chapter, save this workbook with a name such as *Attrition Analysis*

!["canvasofexplaineducationfield"](2ea8c8aadd25610d5d34f1131606dc4d.png)

8. Let’s explore dataset attrition further. One element that we have not yet analyzed in depth is gender. Add a canvas to your workbook by clicking on the + sign at the bottom of the screen and rename the canvas "Gender Analysis".

    !["renamenewcanvasgenderanalysis"](e14d77aefdadff1a14652f6af8bd4975.png)

    Use the search bar at the top left in the dataset panel to generate a visualization based on Gender elements:

    !["searchbar"](33b06bdf1ad0c604abb0253d26d04879.png)

    Search allows you to query your dataset and create visualizations based on the metrics and attributes that interest you. Enter the following column names: "EmployeeCount", "Attrition", and "Gender", selecting each column as it appears. The auto-complete search feature is very handy, so you often just need to type part of the column name to find it. Select each column as it appears and add it to the search bar.

    Once the three columns are displayed in the search bar, simply clicks drag onto the empty canvas or choose to create a visualization below the search bar, which results in the following visualization:

    !["createvisual"](ca2318a587b9d0662ecd1957a71ebd5b.png)

    The end result should look like this:

    !["barchartofattriton,genderandemployeecount"](cabcc15adeb6d9713a5aa1597ac19bd4.png)

    We see that in raw numbers, more men than women have left our organization. Let's change the chart type to proportionally determine the number of men and women who left the organization. It's easy to change the chart type by selecting another chart using the icons at the top right of the chart or in the chart layout panel. Whichever method you use, change the chart layout to a 100% stacked horizontal bar chart. Then just drag Gender to Category (X-Axis) and Attrition to Color so we can see the percentage of men and women leaving the company or staying as shown below below:

    !["swapx-axiswithcolor"](b830b5f5ab76fed3b6c01734e125f699.png)

    Now let's use a one-click advanced analysis feature to dig deeper into the gender question. In the Data Elements panel, use the multi-select key on your computer to select *Gender*, *EnvironmentSatisfaction*, *WorklifeBalance*, and *Last Name*. then right-click and choose the *Scatter* chart option. Finally, move *Gender* to Trellis Columns. Your visualization should look like this:

    !["choosescatterchartandmovegendertotrellisrows"](94d8a3f8ab612b715a76dc0c3837376f.png)

**Note:** you can simply drag a visualization above, below, or next to another visualization to order them however you want.

At any point in the scatterplot, right-click and choose *Add Statistics.. Outliers*. Outliers will be highlighted with different colors to make them easier to identify.

!["addoutliers"](6d458c84e0b343a603d3cc22becc0730.png)

If we consider employees who are not in the outliers (which represents the majority), we see that women seem to have a lower level of environmental satisfaction and work-life balance than their peers. male counterparts. This may be a key factor in understanding what drives women to leave our organization.

Save your analysis.

## Leveraging Machine Learning in Oracle Analytics Server to Predict Voluntary Attrition

This exercise will explore how self-service machine learning enables predictive analytics using native machine learning models contained in Oracle Analytics Server. We will now extend our analysis by seeing how we can predict whether an employee is likely to leave the organization. To do this, we will use a binary classification model. Before venturing further, let's try to briefly understand what binary classification is.

Binary classification is a technique of classifying items in a given dataset into two groups based on classification rules, for example predicting employee attrition, i.e. whether The employee is expected to leave or not leave. These rulesClassifications are generated when we train a model using a training dataset that contains employee information and whether the employee left the company or not.

1. On the home page, click the Create button and select Dataflow.

    !["createdataflow"](4c82dad206c88b94a20cf27b05cb782c.png)

2. Select the dataset we are analyzing “Attrition Training V3.” and click Add.

    !["chooseattritiontrainingv3dataset"](082c4b4666d087dc188c087c223b75dd.png)

3. This dataset will be added as a source of information for our data flow.

    !["datasetattritiontrainingv3 "](abf44434d438788b15d0004bcf764367.png)

4. In the last example, we noticed that there was attrition in our department and we took note of some of the factors identified using the explain function. What we want to do now is build and train a machine learning model to predict whether someone is likely to leave the organization. Let's add a machine learning algorithm to our data flow.

    Select the *plus* icon on the source data and select *Train Binary Classifier*.

    !["trainbinaryclassifiermodel"](e720e606bf678b6ddf73bb82dc796858.png)

5. Select *Naïve Bayes for Classification* and click OK.
6. Select the *Attrition* attribute as the target column of the model. Make sure the positive class is *Yes* and leave the other options as default.

    !["targetcolumnsisatrition"](b4799710103230cdd48fc1baa8485d10.png)

7. Click *Save Model* and give the model a name like "AttritionPredict-BC-NB".

    !["savemodelasatritionpredict-bc-nb"](9f5c532670463b9c0f9f5bc8a33493c3.png)

8. Save your Data Flow with a name like *AttritionPredict-BC-NB* or similar

    !["savedataflowasatritionpredict-bc-nb"](0aecacbcffc28ac22654c9d6864b0a53.png)

9. Run the Data Flow once it has been saved. Wait for the Process to end.

    !["rundataflow"](8e9515a3cb18e2f83bc93ac294cd2e29.png)

10. Exit the Data Flow and from the Home page, open the Machine Learning tab to review the results of the classification model.

    !["machinelearningsection"](b19d9d3127ee87ed4543ba2576bd0de2.png)

11. We can check the validity of our machine learning model. Click on the dots on the right side and select "Inspect".

    !["attritionpredict-bc-nbmodelinspectoption"](35f77e900f83a9c8a717581b2b26c260.png)

12. We can inspect the model to see more details like the quality of the model (confusion matrix, precision, recall) and the generated datasets. The quality tab identifies the overall quality of the model using a series of Related measurements: The overall accuracy of the model is 87% and the accuracy is 65%.

    !["reviewqualityofthemodel"](03ecdb105264dea75c1c3ae1b46a2c5a.png)

13. Since the model achieved an accuracy rate of 87%, let's apply it to a dataset of employees who remain with our organization to see which of them might be inclined to leave. Click on the three dots at the top right, then select *Import Workbook/Flow*.

    !["importworkbookflow"](335bdf655d56df59857d5d9c0e8afb66.png)

14. select the *Employee-Analysis.dva* file.

    !["employee-analysisdvafile"](344f38543b37737ef6960d3df289ddb2.png)

15. Enter the password *“Admin123”*.

    !["passwordprompt"](3f8f2c780901c99c91eb87360641b27a.png)

16. Find and open the workbook titledé Employee Analysis. Here we have an existing workbook that profiles 470 employees within our organization. We will apply our new classification training model to this dataset that we imported with this workbook.

    !["employeeanalysisworkbook"](3d17081b40379b0e2cc5fb74c2e5fafb.png)

17. Go to the Home tab and create a new *data flow*.

    !["createdataflow"](4c82dad206c88b94a20cf27b05cb782c.png)

18. Select the new “Attrition Predict” dataset.

    !["attritionpredictdataset"](60b1d64584f25014705a7e5cb8cb66c2.png)

19. Click on the *plus icon* icon.

    !["plusicontorightofdataset "](38157825a53a2cc29c91a4469dd2755c.png)

20. Select *Apply Model*.

    !["applymodelicon"](cbe9961abd0749caae5a2741f67830e4.png)

21. Select our Machine Learning model and click OK.

    !["attritionpredict-bc-nbmodel"](560d43181bb605f295294925d295cc1b.png)

22. Our application template will have 3 sections.
    - **Outputs** - this is a list of columns returned by the model in addition to the input columns. Applying the model will enrich our employee dataset by adding a predicted value and a prediction confidence score.
    - **Parameters** - Optional parameters that users can pass to apply the template.
    - **Inputs** - These are the template input columns for the "apply".

        The application model will attempt to automatically match the input dataset column names to the model column names.

        !["applymodelconfiguration"](5dd932c1d49894b6cd17ddf4b74b9920.png)

23. Select the *plus icon* and select *Save Data*.

    !["savedataicon"](63a395d6c420e7a3025293e1c0502add.png)

24. Give it the name “AttritionPredicted”.

    !["savedataconfiguration"](8dfc8809f1cff6b290f5171e1ccf8d12.png)

25. **Note**: We can run this data flow in an existing database if we want. For now, this is the default storage for datasets.
26. Save the data flow under the name “AttritionPredicted”.

    !["savedataflowasatritionpredicted"](8109900e96096934ba7a73ac57907ba5.png)

27. Once the data flow is saved, run it.

    !["rundataflowicon"](ce73a7d0fdb12b935540a71ebe8398b2.png)

    This will produce a new dataset that will add the predicted values ​​to our existing dataset.

28. Go to the “Data” tab and select the new “AttritionPredicted” dataset.

    !["attritionpredicteddataset"](676a7d9d4587e3d503e51e0eaa6dc796.png)

29. Some columns may be stored incorrectly. As we did in the previous exercises, make sure that:

The following columns are stored as measures:

- PredictionConfidence
    -EmployeeCount
    - Employee number is an attribute.

        !["attributeeditor"](851967fd27e8b5af137fa11a631f9958.png)

30. Create visualizations like the following example:
    - Performance Tile for EmployeeCount
    - Donut chart for EmployeeCount by JobRole and Department
    - Table with columns EmployeeNumber, First Name, Last Name, PredictionConfidence, PredictedValue

        !["visulizationsoncanvas"](567da9a59c4e27d8168c101adb6ba341.png)

31. Save the workbook naming it “AttritionPredicted”.

    !["saveprojectpanel"](515a5b8477e6dbf371fa56597ac59c37.png)

## Leverage machine learning in Oracle database to predict voluntary departures

This exercise will explore how to leverage learningautomatic Oracle Database (OML) from Oracle Analytics Server. The main difference from the previous exercise is that we used a native machine learning model running in OAS to predict attrition. While this approach works well with limited amounts of data, it is not necessarily optimal when working with large amounts of data. Oracle Database offers distinct performance advantages for hosting machine learning workloads that Oracle Analytics Server simply cannot match. Oracle database can leverage in-memory constructs, parallel processing, sophisticated query plans, and more. to provide a very robust environment for machine learning workloads. It is also common in the industry for a professional development team to train, test, evaluate, and deploy machine learning models in a robust dedicated compute environment such as Oracle Database. Our goal in this exercise is therefore to illustrate how an analyst can easily and quickly exploit the machine models hosted in the Oracle database from Oracle Analytics Server.

In this scenario, we will start by saving a machine learning model that our professional scientists have previously trained, tested and deployed into the Oracle database. Once saved, we will call this model to predict who in our organization is likely to leave the organization.

For this exercise, we will reuse the connection created in exercise 2 of the previous chapter. We will create a Dataset from this connection. The employee data needed to predict who might leave our organization is already in our Oracle database

**Note**: To fully leverage the capabilities of OML, both the machine learning model and the data needed to make a prediction must be in the Oracle database

1. From Home, Click on Create then choose Dataset

    ![](80404ed568639aeb3cf7b4c800d33a83.png)

2. Select the ‘orclpdb’ connection, select the EMPLOYEE_DATA table in the dmuser01 schema, then drop it into the panel on the right of the screen.

    ![](85dbf1b46ccb63c709bde87817466106.png) ![](e4d02a98f5320b13b5a9342ca9b1731b.png)

3. Change the Age and EmployeeNumber columns to attribute and save the dataset with the name EMLOYEE_DATA.
4. Return to Home, and at the top right, click on the three vertical dots to open the drop-down menu, then select Register ML Model.

    !["registermlmodeloption"](a1452b933a84561f2426c3ad0a9a38d9.png)

5. Select the orclpdb connection that was created at the beginning of the chapter.

    ![](efcbd5e83379cac703d0d828a1883e82.png)

6. Now select “*ATTRITION-MODEL-SVM*” from the list of available ML models and click Register at the bottom of the page.

    !["attritionmodelsvm"](9d9670c16bf172abe4b838b13cf04fbf.png)

7. From the home page, click the hamburger button at the top left, select Machine Learning, and for the ATTRITION-MODEL-SVM model we just saved, select the Inspect option using the three vertical points that appear on the right side of the model.

    !["paneltoinspectattritionmodelsvm"](c50ed3ee9e0364a110671a305da302e7.png)

8. Inspectr the saved model. Note that there is more metadata appearing on OML models hosted in the Oracle database than on native ML models hosted in Oracle Analytics Server. This shows that OML models are much more sophisticated. Browse the different tabs (General, Access, Details, Related). Notice that under Details - Exit Columns there is a Prediction and a PredictionProbability which will tell us who is likely to leave next. Likewise, the Related tab offers a series of underlying metadata stored in DM\$ views within the Oracle database, containing important details about how the model was trained, tested, and evaluated

    !["relatedtabforinspectattritionmodelsvm"](2a889b76a7657b06e69265ec07b5635e.png)

9. Our saved OML model is now ready to be called by Oracle Analytics Server to make predictions about which employees are likely to leave the organization. To call this saved OML model, click Create at the top right of the page, then choose Data Flow.

    !["dataflowcreateicon"](846a94419fbf0ae31b138695f2d7a96a.png)

10. The authoring data flow will ask you which dataset(s) you want to use. Type "EMP" in the search window, then select EMPLOYEE-DATA and Add to enter a dataset containing key information about the remaining employees still working for our organization.

    !["edatatablefromoracledb"](f1eeef2e2bd9b4d8a5c8d707ba203170.png)

11. Click the + sign to the right of the EMPLOYEE_DATA node we just added to the dataflow and choose Apply Model at the bottom of the elements presented.

    !["plusiconandapplymodelicon"](b5a6d36e926c9e6a52166ccf0159ffba.png)

12. Select ATTRITION-MODEL-SVM that we saved in step 6 above, then click OK.

    ![](ff0e84cd6b1e2e8cd3f107a5e3e1a00b.png)

13. Since a similar dataset was used to train and test our model, the Prediction and PredictionProbability outputs are automatically mapped to the input columns needed to create our predictions.

    !["applymodelconfigpanel"](e71139511f71e5df309961a3d395c385.png)

14. Click the + sign to the right of the Apply Model node and choose Save Data

    !["plusiconandsavedataicon"](70817d0773a7d9de7518a3349dae7ea3.png)

15. Save the new dataset in the orclpdb database with the name PRED_EMP_ATTRIT. Give this name also for the dataset.

    ![](c3106d3393513ac00c2004fb709671c6.png)

16. Save your data flow naming it PRED-EMP-ATTRIT-OML then, using the arrow at the top right of the page, run the dataset to create the predictions.

    !["savedataflowpanela"](d4fca3123709336fcee81ebf8eac1d4a.png)

17. Once the model has been applied, exit the data flow you have just created.
18. Using the hamburger icon at the top left of the page, open the DATA panel and enter EMP to see all datasets with "EMP" in their name. Click on the PRED-EMP-ATTRIT dataset to create a new workbook.

    !["predempatrittable"](c449bef822e5725d5caee5de27c65970.png)

19. Select all columns in the dataset, right-click and select Pick Visualization. Then choose the Table visualization to view the predictions.

    !["columnselectionpanel"](05c2fc500fb71e30ee88a1fac80cbbc9.png)

20. Using the drag and drop techniqueser, rearrange the columns in each row so that Prediction, PredictionProbability, and EmployeeNumber appear on the right side of the table. You can also move key attributes such as DEPARTMENT, JOBROLE, ... to the right side.

    !["columnsrearrangedintable"](066cf1353d08cfec0dba7f9bb345bee0.png)

21. Click the Prediction attribute and drag it to the Filters section at the top of the page, then filter only on employees whose prediction is Yes, meaning they are likely to leave. Then sort based on “PredictionProbability” from top to bottom to see which employees have the greatest risk of leaving.

    !["tablefilteredandsorted"](344f45cd58121247f691fa19b052a148.png)

22. Continue building visualizations that you think might help understand attrition predictions until you have an interesting canvas.

    !["finalcanvas"](64e8727d030ef431c49ea04138355511.png)